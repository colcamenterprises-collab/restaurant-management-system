Update Zod Schema (client/src/pages/DailyStockSales.tsx - Replace formSchema)
Replace the formSchema object with this (coerce string to number, optional with default 0):
typescript

Collapse

Unwrap

Run

Copy
const formSchema = z.object({
  grabSales: z.coerce.number().min(0).optional().default(0),
  directSales: z.coerce.number().min(0).optional().default(0),
  aroiDeeSales: z.coerce.number().min(0).optional().default(0),
  qrScanSales: z.coerce.number().min(0).optional().default(0),
  cashSales: z.coerce.number().min(0).optional().default(0),
  totalSalesAmount: z.coerce.number().min(0).optional().default(0),
  // Other fields...
});
Auto-Calc Total Sales (Add to useForm onSubmit or watch)
Add watch and setValue for real-time calc (around line 100-200 in useForm hook):
typescript

Collapse

Unwrap

Run

Copy
const form = useForm({
  resolver: zodResolver(formSchema),
  defaultValues: {
    grabSales: 0,
    directSales: 0,
    aroiDeeSales: 0,
    qrScanSales: 0,
    cashSales: 0,
    totalSalesAmount: 0,
  },
});

// Auto-calc total
const [grab, direct, aroi, qr, cash] = form.watch(['grabSales', 'directSales', 'aroiDeeSales', 'qrScanSales', 'cashSales']);
useEffect(() => {
  const total = (grab || 0) + (direct || 0) + (aroi || 0) + (qr || 0) + (cash || 0);
  form.setValue('totalSalesAmount', total);
}, [grab, direct, aroi, qr, cash]);
Input JSX Fix (Make Number Inputs, Default 0)
For each sales input (e.g., Grab Sales):
tsx

Collapse

Unwrap

Copy
<Input 
  type="number"
  {...register("grabSales", { valueAsNumber: true })} 
  placeholder="0" 
  defaultValue={0}
/>
Repeat for directSales, aroiDeeSales, qrScanSales, cashSales, totalSalesAmount (read-only for total).
Backend Default Handling (server/routes.ts - /api/daily-stock-sales POST)
Ensure string to number on save:
typescript

Collapse

Unwrap

Run

Copy
app.post("/api/daily-stock-sales", async (req: Request, res: Response) => {
  try {
    const data = req.body;
    const parsed = {
      ...data,
      grabSales: parseFloat(data.grabSales || '0'),
      directSales: parseFloat(data.directSales || '0'),
      aroiDeeSales: parseFloat(data.aroiDeeSales || '0'),
      qrScanSales: parseFloat(data.qrScanSales || '0'),
      cashSales: parseFloat(data.cashSales || '0'),
      totalSalesAmount: parseFloat(data.totalSalesAmount || '0'),
    };
    // Insert parsed
    const result = await storage.createDailyStockSales(parsed);
    res.json(result);
  } catch (err) {
    res.status(500).json({ error: "Failed to create" });
  }
});
Test Steps
Save changes, restart app (npm run dev).
Load form, enter strings/numbers (e.g., "4667" for Grab), watch total auto-calc.
Submitâ€”should succeed, DB stores numbers.
If error, console.log(form.getValues()) in onSubmit to debug.
Proactive: This fixes string/number mismatch across frontend/backend, defaults blanks to 0, auto-calc total. If form still fails, share full DailyStockSales.tsx code