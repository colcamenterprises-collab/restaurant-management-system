âœ… Final Fix Instructions for the Replit Agent
ğŸ“Œ Objective:
Show only the most recent shift (5 PM â€“ 3 AM) on the Daily Receipts Page

Display only receipts from that shift, not the full 31 days

Ensure accurate drink quantities

Feed rolls, meat, and drinks into the Analysis Page

Display the summary section on the Home Page

Add option to download the summary report

Keep Jussi available to regenerate daily reports

Ensure monthly receipts remain cached in background for MTD analysis

ğŸ§  Replit Agent Instruction Block
ts
Copy
Edit
/**
 * ğŸ§¾ Daily Receipt Summary System - Final Fixes
 * Agent Name: Jussi - Head of Operations
 */

1. âœ… Limit data shown on `/receipts/summary` page to:
   - Only **latest shift** (from 5 PM to 3 AM BKK time)
   - Use `created_at` timestamps to filter shift correctly
   - Show:
     - First & last receipt numbers of the shift
     - Total # of receipts
     - Gross + Net sales
     - Drink quantities (accurate count of each brand)
     - Burger rolls used = burger items sold
     - Shift period and date

2. ğŸ“ Retain full 31-day data in background:
   - Cache data server-side (not in UI) for analysis modules
   - Jussi should generate daily summaries for all 31 days using this cache

3. ğŸ¹ Fix Drinks Summary:
   - Fetch drink quantities based on exact item name match
   - Show quantity next to each drink name
   - e.g. `Sprite â€“ Qty: 12`, not just red dashes

4. ğŸ“¦ Roll Usage:
   - Display â€œBurger Rolls Usedâ€ by counting all burger-type items
   - 1 roll per burger sold (regardless of size)

5. ğŸ¥© Add Meat Calculation Architecture:
   - Add placeholder on backend for meat calculation (90g per patty)
   - Donâ€™t display yet, but prepare function for `getMeatUsageForShift(date)`

6. ğŸ“¥ Download Button:
   - Add download button on `/receipts/summary` page
   - Export full summary for current shift as `.csv` or `.pdf`

7. ğŸ“Š Feed Data into `/analysis` page:
   - Connect:
     - Rolls used (from burger sales)
     - Drinks sold
     - Meat placeholder (for later integration)
   - Populate charts/cards with shift-based calculations

8. ğŸ  Home Page Summary:
   - Display compact stats for latest shift:
     - Receipts count
     - Gross sales
     - Burger rolls used
     - Drink sold summary (e.g., Sprite: 12, Coke: 8)

9. ğŸ” Jussi Tasks:
   - Regenerate summary for current shift (button available)
   - Loop through 31 days and generate archived daily summaries (once)

10. ğŸ§ª Final Test:
    - Use July 29 shift as test
    - Check: Receipt range, drinks qty, roll count, export works

